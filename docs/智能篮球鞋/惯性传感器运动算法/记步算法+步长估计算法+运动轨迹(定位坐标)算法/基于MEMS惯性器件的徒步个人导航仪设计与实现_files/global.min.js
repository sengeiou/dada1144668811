(function(n,t,i){var d="TEXTAREA",g="function",nt="password",c="maxLength",a="type",r="",u=!0,tt="placeholder",e=!1,it="watermark",o=it,s="watermarkClass",y="watermarkFocus",v="watermarkSubmit",p="watermarkMaxLength",h="watermarkPassword",f="watermarkText",l=/\r/g,ut=/^(button|checkbox|hidden|image|radio|range|reset|submit)$/i,rt="input:data("+o+"),textarea:data("+o+")",w=":watermarkable",b=["Page_ClientValidate"],k=e,ft=tt in document.createElement("input");n.watermark=n.watermark||{version:"3.1.4",runOnce:u,options:{className:it,useNative:u,hideBeforeUnload:u},hide:function(t){n(t).filter(rt).each(function(){n.watermark._hide(n(this))})},_hide:function(n,i){var o=n[0],b=(o.value||r).replace(l,r),v=n.data(f)||r,y=n.data(p)||0,w=n.data(s),u,e;v.length&&b==v&&(o.value=r,n.data(h)&&(n.attr(a)||r)==="text"&&(u=n.data(h)||[],e=n.parent()||[],u.length&&e.length&&(e[0].removeChild(n[0]),e[0].appendChild(u[0]),n=u)),y&&(n.attr(c,y),n.removeData(p)),i&&(n.attr("autocomplete","off"),t.setTimeout(function(){n.select()},1)));w&&n.removeClass(w)},show:function(t){n(t).filter(rt).each(function(){n.watermark._show(n(this))})},_show:function(t){var w=t[0],d=(w.value||r).replace(l,r),i=t.data(f)||r,b=t.attr(a)||r,g=t.data(s),e,o,v;d.length!=0&&d!=i||t.data(y)?n.watermark._hide(t):(k=u,t.data(h)&&b===nt&&(e=t.data(h)||[],o=t.parent()||[],e.length&&o.length&&(o[0].removeChild(t[0]),o[0].appendChild(e[0]),t=e,t.attr(c,i.length),w=t[0])),(b==="text"||b==="search")&&(v=t.attr(c)||0,v>0&&i.length>v&&(t.data(p,v),t.attr(c,i.length))),g&&t.addClass(g),w.value=i)},hideAll:function(){k&&(n.watermark.hide(w),k=e)},showAll:function(){n.watermark.show(w)}};n.fn.watermark=n.fn.watermark||function(i,p){var it="string",k,b;return this.length?(k=e,b=typeof i==it,b&&(i=i.replace(l,r)),typeof p=="object"?(k=typeof p.className==it,p=n.extend({},n.watermark.options,p)):typeof p==it?(k=u,p=n.extend({},n.watermark.options,{className:p})):p=n.watermark.options,typeof p.useNative!=g&&(p.useNative=p.useNative?function(){return u}:function(){return e}),this.each(function(){var et="dragleave",ot="dragenter",ut=this,e=n(ut),st,g,it,rt;if(e.is(w)){if(e.data(o))(b||k)&&(n.watermark._hide(e),b&&e.data(f,i),k&&e.data(s,p.className));else{if(ft&&p.useNative.call(ut,e)&&(e.attr("tagName")||r)!==d){b&&e.attr(tt,i);return}e.data(f,b?i:r);e.data(s,p.className);e.data(o,1);(e.attr(a)||r)===nt?(st=e.wrap("<span>").parent(),g=n(st.html().replace(/type=["']?password["']?/i,'type="text"')),g.data(f,e.data(f)),g.data(s,e.data(s)),g.data(o,1),g.attr(c,i.length),g.focus(function(){n.watermark._hide(g,u)}).bind(ot,function(){n.watermark._hide(g)}).bind("dragend",function(){t.setTimeout(function(){g.blur()},1)}),e.blur(function(){n.watermark._show(e)}).bind(et,function(){n.watermark._show(e)}),g.data(h,e),e.data(h,g)):e.focus(function(){e.data(y,1);n.watermark._hide(e,u)}).blur(function(){e.data(y,0);n.watermark._show(e)}).bind(ot,function(){n.watermark._hide(e)}).bind(et,function(){n.watermark._show(e)}).bind("dragend",function(){t.setTimeout(function(){n.watermark._show(e)},1)}).bind("drop",function(n){var t=e[0],i=n.originalEvent.dataTransfer.getData("Text");(t.value||r).replace(l,r).replace(i,r)===e.data(f)&&(t.value=i);e.focus()});ut.form&&(it=ut.form,rt=n(it),rt.data(v)||(rt.submit(n.watermark.hideAll),it.submit?(rt.data(v,it.submit),it.submit=function(t,i){return function(){var r=i.data(v);n.watermark.hideAll();r.apply?r.apply(t,Array.prototype.slice.call(arguments)):r()}}(it,rt)):(rt.data(v,1),it.submit=function(t){return function(){n.watermark.hideAll();delete t.submit;t.submit()}}(it))))}n.watermark._show(e)}})):this};n.watermark.runOnce&&(n.watermark.runOnce=e,n.extend(n.expr[":"],{data:n.expr.createPseudo?n.expr.createPseudo(function(t){return function(i){return!!n.data(i,t)}}):function(t,i,r){return!!n.data(t,r[3])},watermarkable:function(n){var t,i=n.nodeName;return i===d?u:i!=="INPUT"?e:(t=n.getAttribute(a),!t||!ut.test(t))}}),function(t){n.fn.val=function(){var u=this,e=Array.prototype.slice.call(arguments),s;return u.length?e.length?(t.apply(u,e),n.watermark.show(u),u):u.data(o)?(s=(u[0].value||r).replace(l,r),s===(u.data(f)||r)?r:s):t.apply(u):e.length?u:i}}(n.fn.val),b.length&&n(function(){for(var i,r,u=b.length-1;u>=0;u--)i=b[u],r=t[i],typeof r==g&&(t[i]=function(t){return function(){return n.watermark.hideAll(),t.apply(null,Array.prototype.slice.call(arguments))}}(r))}),n(t).bind("beforeunload",function(){n.watermark.options.hideBeforeUnload&&n.watermark.hideAll()}))})(jQuery,window),function(n,t){var i=function(){function r(t,r){t=="dot"?(r='<ol class="dots">',n.each(i.li,function(n){r+='<li class="'+(n==i.i?t+" active":t)+'">'+ ++n+"<\/li>"}),r+="<\/ol>"):(r='<div class="',r=r+t+'s">'+r+t+' prev">'+i.o.prev+"<\/div>"+r+t+' next">'+i.o.next+"<\/div><\/div>");i.el.addClass("has-"+t+"s").append(r).find("."+t).click(function(){var t=n(this);t.hasClass("dot")?i.stop().to(t.index()):t.hasClass("prev")?i.prev():i.next()})}var i=this;i.o={speed:500,delay:3e3,init:0,pause:!t,loop:!t,keys:t,dots:t,arrows:t,prev:"&larr;",next:"&rarr;",fluid:t,starting:t,complete:t,items:">ul",item:">li",easing:"swing",autoplay:!0};i.init=function(t,u){i.o=n.extend(i.o,u);i.el=t;i.ul=t.find(i.o.items);i.max=[t.outerWidth()|0,t.outerHeight()|0];i.li=i.ul.find(i.o.item).each(function(){var t=n(this),r=t.outerWidth(),u=t.outerHeight();r>i.max[0]&&(i.max[0]=r);u>i.max[1]&&(i.max[1]=u)});var u=i.o,e=i.ul,f=i.li,o=f.length;if(i.i=0,t.css({width:i.max[0],height:f.first().outerHeight(),overflow:"hidden"}),e.css({position:"relative",left:0,width:o*100+"%"}),f.css({float:"left",width:i.max[0]+"px"}),u.autoplay&&setTimeout(function(){if(u.delay|0&&(i.play(),u.pause))t.on("mouseover mouseout",function(n){i.stop();n.type=="mouseout"&&i.play()})},u.init|0),u.keys&&n(document).keydown(function(n){var t=n.which;t==37?i.prev():t==39?i.next():t==27&&i.stop()}),u.dots&&r("dot"),u.arrows&&r("arrow"),u.fluid&&n(window).resize(function(){i.r&&clearTimeout(i.r);i.r=setTimeout(function(){var n={height:f.eq(i.i).outerHeight()},r=t.outerWidth();e.css(n);n.width=Math.min(Math.round(r/t.parent().width()*100),100)+"%";t.css(n)},50)}).resize(),n.event.special.swipe||n.Event("swipe"))t.on("swipeleft swiperight swipeLeft swipeRight",function(n){n.type.toLowerCase()=="swipeleft"?i.next():i.prev()});return i};i.to=function(r,u){i.t&&(i.stop(),i.play());var f=i.o,o=i.el,h=i.ul,s=i.li,v=i.i,e=s.eq(r);if(n.isFunction(f.starting)&&!u&&f.starting(o,s.eq(v)),!(!e.length||r<0)||f.loop!=t){e.length||(r=0);r<0&&(r=s.length-1);e=s.eq(r);var c=u?5:f.speed|0,l=f.easing,a={height:e.outerHeight()};h.queue("fx").length||(o.find(".dot").eq(r).addClass("active").siblings().removeClass("active"),o.animate(a,c,l)&&h.animate(n.extend({left:"-"+r+"00%"},a),c,l,function(){i.i=r;n.isFunction(f.complete)&&!u&&f.complete(o,e)}))}};i.play=function(){i.t=setInterval(function(){i.to(i.i+1)},i.o.delay|0)};i.stop=function(){return i.t=clearInterval(i.t),i};i.next=function(){return i.stop().to(i.i+1)};i.prev=function(){return i.stop().to(i.i-1)}};n.fn.unslider=function(t){var r=this.length;return this.each(function(u){var f=n(this),e="unslider"+(r>1?"-"+ ++u:""),o=(new i).init(f,t);f.data(e,o).data("key",e)})};i.version="1.0.0"}(jQuery,!1),function(){"use strict";String.prototype.format=function(){var n=this;return arguments.length>0&&$.each(arguments,function(t,i){n=n.replace(new RegExp("\\{"+t+"\\}","g"),i)}),n}}(),function(n){"use strict";var t=n.wf||{};t.namespace=function(n){var t=n.split("."),r=this,i;for(t[0]==="wf"&&(t=t.slice(1)),i=0;i<t.length;i++)typeof r[t[i]]=="undefined"&&(r[t[i]]={}),r=r[t[i]];return r};t.prototype={name:"WF",version:"1.0.0",getName:function(){return this.name}};window.wf=t}(window),function(n){"use strict";var t={micrometer:function(n,t){return t=t||",",n.toString().replace(/[0-9]+?(?=(?:([0-9]{3}))+$)/g,function(n){return n+t})},stopPropagation:function(n){n&&n.stopPropagation?n.stopPropagation():window.event.cancelBubble=!0},supportCss3:function(n){var r=["webkit","Moz","ms","o"],t,i=[],f=document.documentElement.style,u=function(n){return n.replace(/-(\w)/g,function(n,t){return t.toUpperCase()})};for(t in r)i.push(u(r[t]+"-"+n));i.push(u(n));for(t in i)if(i[t]in f)return!0;return!1},animation:function(n,t,i){n.addClass(t).addClass("animated").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){n.removeClass(t).removeClass("animated");$.isFunction(i)&&i()})},browser:{version:function(){var n=navigator.userAgent,t=navigator.appVersion;return{trident:n.indexOf("Trident")>-1,presto:n.indexOf("Presto")>-1,webKit:n.indexOf("AppleWebKit")>-1,gecko:n.indexOf("Gecko")>-1&&n.indexOf("KHTML")==-1,mobile:!!n.match(/AppleWebKit.*Mobile.*/),ios:!!n.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:n.indexOf("Android")>-1||n.indexOf("Linux")>-1,iPhone:n.indexOf("iPhone")>-1,iPad:n.indexOf("iPad")>-1,webApp:n.indexOf("Safari")==-1,isPc:function(){for(var r=navigator.userAgent,t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],i=!0,n=0;n<t.length;n++)if(r.indexOf(t[n])>0){i=!1;break}return i}()}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()}};n.utils=t}(wf),function(n){"use strict";for(var t=n.console||{},u=["assert","clear","count","debug","dir","dirxml","exception","error","group","groupCollapsed","groupEnd","info","log","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],f={version:"0.1.0"},i,r=0,e=u.length;r<e;r++)i=u[r],f[i]=function(n){return function(){if(typeof t[n]=="undefined")return 0;Function.prototype.apply.call(t[n],t,arguments)}}(i);n.console=f}(window),function(n){"use strict";n.cookie={set:function(n,t,i,r,u){document.cookie=[n,"=",t,u?"; expires="+u.toGMTString():"",r?"; path="+r:"",i?"; domain="+i:""].join("")},get:function(n){var t,i=new RegExp("(^| )"+n+"=([^;]*)(;|$)");return(t=document.cookie.match(i))?t[2]:null},remove:function(n){document.cookie=n+"=; expires=Mon, 26 Jul 1997 05:00:00 GMT;"}}}(wf),function(n){"use strict";var t=n.cookie,r=config.domain.base,i="PreferredCulture",u=function(){var n={langCN:"zh-CN",langTW:"zh-TW",langEN:""};return{set:function(u){t.set(i,n[u],r)},get:function(){return t.get(i)},remove:function(){t.remove(i)}}};n.lang=u()}(wf),function(n){"use strict";var t={$cls:".pop",openCls:"open",openBtn:".pop-openBtn",open:function(){config.log.isDebug&&console.log("pop组件打开")},close:function(){config.log.isDebug&&console.log("pop组件关闭")}},i=function(t,i){return t.click(function(n){n&&n.stopPropagation?n.stopPropagation():window.event.cancelBubble=!0}),{close:function(){t.removeClass(i.openCls);i.close&&i.close()},open:function(){var r=this;n(i.$cls).removeClass(i.openCls);t.addClass(i.openCls);i.open&&i.open();n(document).on("click",function(){r.close()})}}};n.fn.pop=function(r){return i(n(this),n.extend(t,r))}}(jQuery),function(n){"use strict";var t=function(){};n.alert=t()}(wf),function(n){"use strict";var t={submitQ:"#q",yearClass:".year",fieldAttr:"data-field",queryArr:[n("#filterBaseQuery").val()],beforeSubmit:null},i=function(i,r){var u=t.queryArr.length;i.off("submit").submit(function(){var s=i.find("input:text").not(r.yearClass),t=i.find("input.begin-year:text"),e=i.find("input.end-year:text"),o=/^\+?[1-9][0-9]*$/,u="",f="";if(!i.data("submited")){if(s.each(function(){var t=n.trim(n(this).val());t&&r.queryArr.push(n(this).attr(r.fieldAttr)+":"+(n(this).data("noquote")?t:'"'+t+'"'))}),(t.length>0||e.length>0)&&(u=t.val()||t.attr("data-value")||"",f=e.val()||e.attr("data-value")||"",u||f)){if(u&&!o.test(u)||f&&!o.test(f))return alert("请输入正确的年份格式"),!1;t.attr("data-title")&&e.attr("data-title")?t.attr("data-title")===e.attr("data-title")?r.queryArr.push(t.attr("data-title")+":"+u+"-"+f):(r.queryArr.push(t.attr("data-title")+":"+u+"-"),r.queryArr.push(e.attr("data-title")+":-"+f)):r.queryArr.push("日期:"+u+"-"+f)}return n(r.submitQ).val(r.queryArr.join(" ")),i.data("submited",!0),n.isFunction(r.beforeSubmit)&&r.beforeSubmit(),!0}})};n.fn.searchFilter=function(r){return i(n(this),n.extend(t,r))}}(jQuery),function(n,t){"use strict";var i=function(){var s=n.utils.stopPropagation,f=t.resource,c=t.domain,i={PRE_CLS:".",FIXED:"fixed",ACTIVE:"active",OPEN:"open",BTN_OPEN:"btn-open",FIXED_CLS:".fixed",SEARCH_WRAP_FIXED_CLS:"search-wrap-fixed"},r=$(".header"),u=r.find(".search-input"),e=r.find(".search-wrap"),y=$("#adSearchBtn"),l=$("#adSearchLink"),a=r.find(".search-ad"),p=r.outerHeight()-e.outerHeight(),o={cls:"search-tip-field",sTipField:[],active:!1,isShow:function(){return r.find(i.PRE_CLS+this.cls).hasClass(i.OPEN)},show:function(){var t=r.find(i.PRE_CLS+this.cls),n=r.find(".lb").data("id"),e,o;if(!this.isShow()&&!u.val()){this.sTipField[n]?t.html(this.sTipField[n]).addClass(i.OPEN):(e=[],o=(f.resource[n]?f.resource[n]:f.library[n]).sField,e.push('<i class="icon icon-drop-arrow-top"><\/i>'),$.each(o,function(n,t){e.push('<div class="field-item">{0}<\/div>'.format(t))}),this.sTipField[n]=e.join(""),t.html(this.sTipField[n]).addClass(i.OPEN));$(i.PRE_CLS+this.cls+" .field-item").click(function(){u.val($(this).text()+":").focus();t.removeClass(i.OPEN)});$(document).one("click",function(n){$(n.target).hasClass("search-input")||t.removeClass(i.OPEN)});t.one("click",function(n){s(n)});this.active||(this.active=!0)}},hide:function(){$(i.PRE_CLS+this.cls).removeClass(i.OPEN)}},w=function(n){$(n.target).hasClass("search-input")||$.each($(".pop"),function(){$(this).removeClass(i.OPEN);$($(this).data(i.OPEN)).removeClass(i.BTN_OPEN)})},h=function(){var i={f:"top",currentdb:"",setQ:null,activeSearchField:!1},n="",s=function(){var o,s;if(!u.val())return u.focus().click(),!1;n=$.trim(u.val());i.setQ&&(n=i.setQ(n));var t=r.find(".lb").data("id"),h=f.resource[t]?f.resource[t]:f.library[t],e=h.db;i.currrentdb&&(e=i.currrentdb);n.indexOf(" ")!=-1&&n.indexOf('"')==-1&&n.indexOf("“")==-1&&(o=/^(标准编号|c|code|stancode|编号)(:|：)(.+)$/gi,o.test(n)&&(n=n.replace(o,'$1$2"$3"')));s=encodeURIComponent(n+(e?" DBID:"+e:""));window.location=u.data("action")+"?q="+s+"&f="+i.f},h=function(){$(".search-btn").click(s);u.keypress(function(n){n.which==13&&s()}).click(function(){e.click();o.show()}).on("input propertychange",function(){if(!u.data("action")||!o.active)return!1;u.val()?o.hide():o.show()});u.on("autocompleteselect",function(n,t){u.val(t.item.value);s()}).autocomplete({appendTo:".search-panel",minLength:1,source:function(n,t){$.ajax({url:c.trend+"AutoComplete",data:{q:n.term},dataType:"jsonp",success:function(n){t($.map(n,function(n){return{label:n,value:n}}))}})},autoFill:!1,close:function(){t.log.isDebug&&console.log("autocomple close")}})};return{render:function(){h()},init:function(n){i=$.extend(i,n);i.echo&&u.val($("#"+n.echo).text());i.activeSearchField&&(o.active=!0)},search:s}}(),v=function(){var t=function(n,t){this.html=[];this.templ=n;this.container=t},l=r.find(".res-drp"),o=l.find(".pop"),a=$("#res"),e={isSearch:!1,id:"paper"},v=function(){var u='<li><a data-action="{0}" data-id="{1}" data-tip="{2}">{3}<\/a><\/li>',i={resource:new t(u,r.find(".resource")),library:new t(u,r.find(".library")),resourceLink:new t('<a href="{0}">{1}<\/a>',r.find(".resource-panel"))};$.each(f,function(t,r){$.each(r,function(r){this.searchTip=this.searchTip.replace(/{total}/,n.utils.micrometer(this.total,", "));i[t].html.push(i[t].templ.format(this.sAction,r,this.searchTip,this.name));t==="resource"&&r!=="paper"&&i.resourceLink.html.push(i.resourceLink.templ.format(this.cAction,this.name))})});$.each(i,function(){this.build()})},c=function(){var n=$(this);a.text(n.text()).data("id",n.data("id"));u.attr("placeholder",n.data("tip")).data("action",n.data("action")).watermark(u.attr("placeholder"))},y=function(){var n=r.find(".drp"),t=r.find(".res-lb");l.hover(function(){o.show()},function(){o.hide()});$.each(r.find(".res-list li a"),function(n){var t=$(this);n==0&&c.call(t);t.click(function(){if(c.call(t),o.hide(),e.isSearch){h.search();return}return u.val("").focus().click(),!1})})},p=function(){var n=r.find("[data-target]");$.each(n,function(){var r=$(this),t=$(i.PRE_CLS+r.data("target"));r.click(function(u){if(r.hasClass(i.ACTIVE))return!1;$(".open,.btn-open").removeClass(i.OPEN).removeClass(i.BTN_OPEN);r.addClass(i.ACTIVE).siblings().removeClass(i.ACTIVE);t.addClass(i.ACTIVE).siblings(".width-wrap").removeClass(i.ACTIVE);$(document).off("click").one("click",function(){t.hasClass(i.FIXED)||(t.removeClass(i.ACTIVE),t.siblings(i.FIXED_CLS).hasClass(i.ACTIVE)||t.siblings(i.FIXED_CLS).addClass(i.ACTIVE));n.removeClass(i.ACTIVE).filter(i.FIXED_CLS).addClass(i.ACTIVE)});s(u)});t.click(function(n){s(n)})});y()};return t.prototype.build=function(){$(this.html.join("")).appendTo(this.container)},{render:function(){v();p()},init:function(n){e=$.extend(e,n);n.id&&c.call($("[data-id="+e.id+"]"))}}}();return h.render(),v.render(),e.click(function(n){w(n)}),y.hover(function(){return a.addClass(i.OPEN),l.attr("href",function(){var n=r.find(".lb").data("id"),t=n;return(n==="qk"||n==="xw"||n==="hy")&&(t="wf_"+n),n==="institution"&&(t="cecdb"),n==="nstr"&&l.hide(),c.librarian+"?dbid="+t}()),!1},function(){a.removeClass(i.OPEN)}),$(window).scroll(function(){var t=$(document).scrollTop()>p;t&&!e.hasClass(i.SEARCH_WRAP_FIXED_CLS)&&n.utils.animation(e,"slideInDown");e[t?"addClass":"removeClass"](i.SEARCH_WRAP_FIXED_CLS)}),{search:h,resource:v,version:"1.0.0"}};n.header=i()}(wf,config),function(n){"use strict";var t=function(){var i=n.lang,t=i.get(),r=$(".lang");return r.click(function(){i.set($(this).attr("id"));window.location.reload()}),t&&(t=t.replace(/zh-/,"")),$("#lang"+t).addClass("current-lang"),{}};n.footer=t()}(wf),function(n){"use strict";var t=function(){var u="logining",e=config.domain.login+"api/login",o=config.domain.login+"/api/ThirdPartyLoginSetting",r=$('<div class="login-mask"><\/div>'),t=$('<div class="login"><div class="hd"><i class="icon icon-close iconfont">&#xe60b;<\/i><\/div><div class="bd"><div class="row row-title"><span class="title">登录<\/span><a href="{0}"  class="register">立即注册 ><\/a><\/div><div class="row row-text"><input type="text" class="userid" placeholder="请输入用户名" /><\/div><div class="row row-text row-password"><input type="password" class="password" placeholder="密码" /><a href="{1}" class="forget-password">找回密码<\/a><span class="error-msg">登录失败<\/span><\/div><div class="row row-auto-login clear"><label class="auto-login-lb" for="autoLogin">自动登录<\/label><input id="autoLogin" type="checkbox" class="auto-login-cbox" /><\/div><button class="row btn btn-login">登录<\/button><div class="row ip-text">欢迎来自{2}的用户<\/div><\/div><div class="ft"><div class="title"><span>其他方式快速登录<\/span><\/div><div class="links"><a class="qq btn" target="_blank" href=""><\/a><a class="weibo btn" target="_blank" href=""><\/a><a class="weixin btn" target="_blank" href=""><\/a><\/div><\/div><\/div>'.format(config.domain.login+"Register/Index",config.domain.login+"Account/GetPassword",config.auth.userIp)),i=t.find(".btn-login"),f=function(){var o=t.find(".userid"),s=t.find(".password"),l=t.find("#autoLogin"),h=t.find(".error-msg"),r={userid:$.trim(o.val()),password:$.trim(s.val()),rememberPassword:l.is(":checked"),noredirect:!0},f={login:"登录",logining:"登录中...",success:"登录成功"},c=function(){h.show();n.utils.animation(h,"shake");i.text(f.login)},a=function(){var i=function(t,i){n.utils.supportCss3("animation")?n.utils.animation(i?i:t,"shake",function(){t.focus()}):t.focus()};return r.userid?r.password?!0:(i(s,t.find(".row-password")),!1):(i(o),!1)};!i.hasClass(u)&&a()&&(i.addClass(u).text(f.logining),$.ajax({url:e,method:"POST",data:r,dataType:"jsonp"}).done(function(n){n?(config.log.isDebug&&console.log("登录成功"),i.off("click").text(f.success),window.location.reload()):(config.log.isDebug&&console.log("登录失败"),c())}).fail(function(n){config.log.isError&&console.log("登录服务出错",n);c()}).always(function(){i.removeClass(u)}))},s=function(){t.find(".row-text input").keypress(function(n){n.which==13&&f()});i.click(f)};return $.ajax({url:config.domain.check+"api/getip",data:{requestUrl:window.location.href},type:"GET",dataType:"jsonp",success:function(n){n.IpString!==config.auth.userIp&&t.find(".bd").append('<div class="row ip-text ip-text-check">欢迎来自'+n.IpString+"的用户<\/div>")}}),{isShow:!1,reset:function(){t.find(".userid").val("");t.find(".password").val("");t.find("#autoLogin").prop("checked",!1);t.find(".error-msg").hide()},close:function(){n.utils.supportCss3("animation")?t.animate({top:"-500px"},300,function(){t.hide().css({top:"50%"});r.hide()}):(t.hide(),r.hide())},open:function(){var i=this,u=t.find(".userid");n.utils.animation(t,"bounceInDown");i.reset();this.isShow?(r.css({height:$(document).height()}).show(),t.show()):($.ajax({url:o,method:"POST",dataType:"jsonp"}).done(function(n){$.each(n,function(n,i){t.find("a."+n).attr("href",i)})}).fail(function(n){config.log.isError&&console.log("第三方接口返回链接出错",n)}),r.css({height:$(document).height()}).appendTo($("body")),t.appendTo($("body")).find(".icon-close").click(function(){i.close()}),this.isShow=!0,s(),t.find("input[placeholder]").each(function(n,t){$(t).watermark($(t).attr("placeholder"))}));u.click();n.utils.browser.version.isPc&&u.focus()}}};n.login=t()}(wf),function(n){"use strict";var t=function(){var s=config.auth,h=n.cookie,u=n.login,c=n.utils.stopPropagation,f={ACCOUNT_TYPE_PERSON:"Person",ACCOUNT_TYPE_GROUP:"Group"},t={},r=$(".header .profile"),i=$(".account-wrap"),e=function(){var n=h.get(s.cookieName);return $.parseJSON(decodeURIComponent(n))},l=function(n,t,i,r){var u=this;u.id=n;u.name=i;u.type=t;u.transactionType=r;$.each(r,function(){$.inArray(this,["IsticTimeLimit","IsticBalanceLimit"])>-1&&(u.hasOrder=!0)})},o=function(n){var t={person:null,groups:[],count:function(){return(this.person?1:0)+this.groups.length},hasAccount:function(){return this.count()>0},contain:function(n){if(this.person&&this.person.id===n)return!0;for(var t=0;t<this.groups.length;t++)if(this.groups[t].id===n)return!0;return!1}},i=function(n){var t=n.split(".");return{type:t.shift(),id:t.shift()}},r=function(t){var r=[],i=[];return $.each(n.AccountIds,function(){i=this.split(".");i.pop()===t&&r.push(i.shift())}),r};return $.each(n.Data,function(){var n=i(this.Key),u=new l(n.id,n.type,this.Value,r(n.id));n.type==f.ACCOUNT_TYPE_PERSON&&(t.person=u);n.type==f.ACCOUNT_TYPE_GROUP&&t.groups.push(u)}),t},a=function(){var e="服务站",o=".display-name",s=i.find(".group-account"),f=i.find(".person-account"),c=i.find(".account-container"),h='<div class="account-tip"><i class="icon icon-success"><\/i>{0}<i class="icon icon-arrow-top"><\/i><\/div>',u=null;n.utils.animation(r,"tip");t.person?(f.find(o).text(t.person.id),$.each(t.person.transactionType,function(){if($.inArray(this,["WBalanceLimit","WTimeLimit"])>-1)return f.find(".last-item").remove(),f.find("a").last().addClass("last-item"),!1})):f.remove();t.count()==1?r.addClass("single").append(h.format("用户中心")):r.addClass("multiple").append(h.format("多个账号已登录"));$.each(t.groups,function(){u=s.clone();u.find(o).text(this.name+e).attr("title",this.name+e);this.hasOrder||u.find(".order-link").remove();u.find(".group-center").attr("href",config.domain.www+"Organization?userId="+this.id);u.appendTo(c)});s.remove()},v=function(){var n="active";r.click(function(){if(t.hasAccount()){i.addClass(n);$(document).on("click",function(t){$(t.target).hasClass("profile")||i.removeClass(n)})}else u.open()});i.find(".login-link").click(function(){u.open()});i.click(function(n){c(n)})},y=e();return t=o(y.Context),config.log.isDebug&&(console.log("generateAccount obj:"),console.log(t)),t.hasAccount()?a():r.attr("title","请登录"),v(),{account:t,refresh:function(){var n=e();this.account=o(n.Context)}}};n.auth=t()}(wf),function(n){"use strict";var t=function(n,t,i,r){var u=config.domain.community+(i?"Services/RelatedResearcherListCache.ashx":"Services/RelatedResearcherList.ashx");$.ajax({url:u,data:{keywords:JSON.stringify(n)},type:"GET",dataType:"jsonp",success:function(n){t(n)}}).always(function(){$.isFunction(r)&&r()})};n.related={researchers:function(){var i=n.lang.get(),r=config.domain.community,u=i!="zh-TW"?"相关学者":"相關學者";return{render:function(n,i){t(i,function(t){if(t!=null&&t.length!=0){var i=$('<ul class="bd clear"><\/ul>');$(t).each(function(n){var u=t[n].ArticleId==""?"":r+"Locate.ashx?ArticleId="+encodeURIComponent(t[n].ArticleId)+"&Name="+encodeURIComponent(t[n].Name);i.append('<li><a target="_blank" '+(u?'href="'+u+'"':"")+">"+t[n].Name+"<\/a><\/li>")});$("#"+n).html('<div class="hd"><span class="title">'+u+"<\/span><\/div>").append(i)}})}}}(),veinChart:function(){var n=config.domain.trend,t=n+"ThumbnailVein?callback=?",i=function(t,i){var u=[],r=i.list,f=r.length,e;if(!(r.length<1)){$.each(r,function(n,t){u.push(t[0]);r[n][0]=n});e=Math.ceil(f/3);$('<div class="hd clear"><span class="title">'+i.keyword+"<\/span>的趋势图<\/div>").appendTo(t);$("#toTrendLink").click(function(){window.open(n+"vein?wd="+encodeURIComponent(i.keyword))});var o=$('<div class="bd"><\/div>',this).appendTo(t).click(function(){window.open(n+"vein?wd="+encodeURIComponent(i.keyword))}),s=[{curvedLines:{show:!0,fit:!0,lineWidth:1},data:r}],h=r[0][0],c=r[r.length-1][0];$.plot(o,s,{series:{lines:{show:!0,lineWidth:2},shadowSize:0,points:{show:f==1}},xaxis:{tickDecimals:0,tickSize:e,tickLength:0,font:{size:9},labelWidth:25,tickFormatter:function(n){var t=u[n];return t?t:""}},yaxis:{font:{size:9}},grid:{color:"#000",borderWidth:1,borderColor:"#BBCCDD",markings:function(n){for(var i=[],t=h;t<=c;t+=2)i.push({xaxis:{from:t-.5,to:t+.5},yaxis:{from:n.yaxis.min,to:n.yaxis.max},color:"#F3F3F3"});return i},labelMargin:5},selection:{mode:"xy"}})}};return{render:function(n,r){r.length<1||$.ajax({url:t,data:{wd:r},dataType:"json",success:function(t){t.list&&t.list.length>0&&i($("#"+n),t)},error:function(n){console.error("获取相关趋势图错误;",n.responseText+","+n.responseXML+","+n.readyState+","+n.status)}})}}}(),word:function(){return{render:function(n,t,i){$.ajax({url:"RelatedWord.aspx",type:"POST",data:{seed:t,pagename:i},success:function(t){$("#"+n).html(t)},error:function(n){console.log(n)}})}}}(),init:function(){var n=$(".related"),f=$(".related .related-item"),o=f.length,r=0,e=function(n){n.hasClass("active")||(n.addClass("active").siblings().removeClass("active"),$("#"+n.data("target")).addClass("show").siblings().removeClass("show"))},i=function(n,t,i){n>0?i.addClass("show"):(i.remove(),t.remove())},u=function(){if(r++,r==1&&n.find(".tab img").remove(),r==o){var t=n.find(".tab-item");t.hasClass("active")||e(t.first())}},s=function(r){var f=r.data("param"),o=r.data("url"),e=$("[data-target="+r.attr("id")+"]");if(r.attr("id")=="relatedResearcher"){t(f,function(n){var u;try{var o=$("[data-target="+r.attr("id")+"]"),s=[],e="",t=f,h=n?n.length:0,c=config.domain.community;if(n&&n.length>0){if($(n).each(function(t){var i=n[t].ArticleId==""?"":c+"Locate.ashx?ArticleId="+encodeURIComponent(n[t].ArticleId)+"&Name="+encodeURIComponent(n[t].Name);s.push('<a class="keyword-item" target="_blank" '+(i?'href="'+i+'"':"")+">"+n[t].Name+"<\/a>")}),t.length>0){for(u=0;u<t.length;u++)t[u]=t[u].replace(/"/g,'\\"'),t[u]='"'+t[u]+'"';e=c+"Scholar.aspx?q="+encodeURIComponent(t.join(" or "))}r.append(s.join(""));e&&n.length>50&&r.append('<\/br><a target="_blank" href="'+e+'" class="btn more-link">更多...<\/a>');$("[data-target="+r.attr("id")+"]").find(".count").text("("+h+")")}i(h,r,o)}catch(l){i(0,r,o);console.error("获取相关学者失败",l)}},!1,u);return}if(!o){u();return}$.post(o,f,function(t){r.html(t);var f=r.find("input"),u=f.val();f.remove();u||(u=0);e.find(".count").text("("+u+")");r.find("button.expend").click(function(){var t=$(this),r=t.find(".text"),u=t.find("i"),i=r.text()==="更多";t.siblings(".more").toggleClass("show");r.text(i?"收起":"更多");u.text(i?"−":"＋");i||$("body,html").animate({scrollTop:n.offset().top-$(".search-panel").height()},100)});i(u,r,e)}).error(function(n){i(0,r,e);console.error("获取相关信息出错",n)}).always(function(){u()})};$.each(f,function(n,t){s($(t))});n.on("click",".tab-item",function(){e($(this))})}}}(wf),function(n){"use strict";n.exporter=function(){var o=n.cookie,y=config.auth.cookieDomain,s="rs",p="/",i="|",h=50,c=$(".record-action-link .exportLink"),f="exported",l="resourceid",u=n.lang.get(),a=!u||u=="zh-CN"?"导出":"導出",v=!u||u=="zh-CN"?"已导出":"已導出",t={repeatAdd:{val:"repeatAdd",msg:a},beyondLimits:{val:"beyondLimits",msg:"一次只允许导出"+h+"条数据!"},success:{val:"success"}},r={get:function(){var n=unescape(o.get(s));return n==="null"?"":n},set:function(n){o.set(s,escape(n),y,p)}},e={validate:function(n,r){var u=n?n.split(i):[],f=u.length-2;return u.length==0?t.success:f>h?t.beyondLimits:$.inArray(r,u)>-1?t.repeatAdd:t.success},remove:function(n){var t=r.get(),u=n+i;t=t.replace(u,"");r.set(t)},add:function(n){var u=r.get(),f=this.validate(u,n);if(u||(u=i),f.val===t.success.val)return u+=n+i,r.set(u),!0;f.val===t.repeatAdd.val||f.val===t.beyondLimits.val&&alert(f.msg)},refresh:function(){var t=r.get(),u=t?t.split(i):[],e=u.length-2;e>0?n.fixbox.exportBox.set(e).show():n.fixbox.exportBox.hide();$.each(c,function(){var n=$(this);$.inArray(n.data(l),u)>-1?n.addClass(f).find(".text").text(v):n.removeClass(f).find(".text").text(a)})},init:function(){var t=config.domain.s+"Export/Export.aspx",n=this;c.click(function(){var i=$(this);n.add(i.data(l))&&(i.addClass(f).find(".text").text(v),window.open(t,"exportWin"),n.refresh())});e.refresh();setInterval(e.refresh,1500)}};return e}()}(wf),function(n){"use strict";$.fn.goTop=function(n){var t=$(this);n=$.extend({min:150,fadeSpeed:600,gotoTopTime:300},n);t.click(function(){$("body,html").animate({scrollTop:0},n.gotoTopTime)});$(window).scroll(function(){$(window).scrollTop()>n.min?t.fadeIn(n.fadeSpeed):t.hide()})};n.fixbox=function(){var n=$('<div class="fix-box"><\/div>');return{gotoTop:function(){var t=$('<div class="fix-box-item goto-top-box"><i class="icon icon-goto-top"><\/i><div class="text">回到顶部<\/div><\/div>');return{init:function(){t.appendTo(n);t.goTop()}}}(),exportBox:function(){var t=$('<a class="fix-box-item export-box" target="exportWin" href="{0}Export/Export.aspx"><div class="count"><\/div><div class="text">已导出<\/div><\/a>'.format(config.domain.s));return{init:function(){t.appendTo(n)},show:function(){return t.css({display:"block"}),this},hide:function(){return t.hide(),this},set:function(n){return t.find(".count").html(n+"条"),this}}}(),init:function(t){t=t||$("body");n.appendTo(t)}}}();n.fixbox.gotoTop.init();n.fixbox.exportBox.init()}(wf),function(n){"use strict";n.citenotice=function(){var t=$(".record-action-link .citenotice"),i=config.domain.citenotice+"CiteNoticeAdd.aspx?jsoncallback=?",r=config.domain.login+"&needLoginAccountType=Person",u="resourceid",f="href";return{add:function(t,u){var f=n.auth.account.person;f?$.ajax({url:i,method:"GET",data:{userID:f.id,articleIDList:t},dataType:"jsonp"}).done(function(n){if(n.IsSuccess){config.log.isDebug&&console.log("添加到引用通知成功");var t=window.open("_blank");t.location=u}else config.log.isDebug&&console.log("登录失败，errorcode："+n.ErrorCode),n.ErrorCode==-1?window.location.href=r:n.ErrorCode==-2&&alert("添加没有成功，请重试。")}).fail(function(n){config.log.isError&&console.log("添加到引用通知服务出错",n)}):n.login.open()},init:function(){var n=this;t.click(function(){var t=$(this);n.add(t.data(u),t.data(f))})}}}()}(wf),function(n){"use strict";var t=function(){var n=$(".share-md"),t=function(n,t,i){function r(){window.open(n,"shareto",u)||(document.href=n)}var u=["tollbar=0,status=0,resizable=0,width=",t,",height=",i,",top=",(screen.height-i)/2,",left=",(screen.width-t)/2].join("");/Firefox/.test(navigator.userAgent)?setTimeout(r,0):r()},i=function(i){var e=$(".share-md"),u=n.find('input[name="shareContent"]').val(),f=n.find('input[name="sharelogo"]').val(),r=n.find('input[name="shareUrl"]').val();r=r?r:document.location.href;u||(u=document.title);f||(f="");r||(r=location.href);i=="weibo"?void function(n,i){var o=n.location.href,e=["url=",i(r),"&title=",i(u),"&appkey=2638752175","&pic=",i(f)].join("");t(["http://v.t.sina.com.cn/share/share.php?",e].join(""),650,450)}(document,encodeURIComponent):i=="douban"?void function(){var i=document,n=encodeURIComponent,e=window.getSelection,o=i.getSelection,s=i.selection,h=e?e():o?o():s?s.createRange().text:"",c="http://shuo.douban.com/%21service/share?href="+n(r)+"&name="+n(u)+"&text="+n(u)+"&image="+n(f)+"&sel="+n(h)+"&v=1";t(c,450,330)}():i=="renren"?void function(n,i){var s=n.location,e=u,o=[i(r),"&title=",i(e),"&description=",i(e),"&images=",i(f)].join("");t(["http://widget.renren.com/dialog/share?resourceUrl=",o].join(""),626,436)}(document,encodeURIComponent):i=="tenxun"&&void function(n,i){var e=i(u),o=i(r),s=i("appkey"),h=i(f),c="http://v.t.qq.com/share/share.php?url="+o+"&appkey="+s+"&site=&pic="+h+"&title="+e;t(c,628,439)}(document,encodeURIComponent)};return{shareTo:i,init:function(){var t=this;n.find(".share-item").click(function(){t.shareTo($(this).data("target"))})}}};n.share=t()}(wf);
/*
//# sourceMappingURL=global.min.js.map
*/